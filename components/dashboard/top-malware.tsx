"use client"

import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import ApexChart from "@/components/ui/apex-chart"

interface MalwareDataPoint {
  date: string
  [key: string]: string | number
}

interface TopMalwareProps {
  data: MalwareDataPoint[]
  malwareNames: string[]
  colors?: string[]
}

export function TopMalware({ 
  data, 
  malwareNames,
  colors = ["#845EFF", "#FF9500", "#4CAF50", "#2196F3", "#FF5050"] 
}: TopMalwareProps) {
  // Format data for ApexCharts
  const series = malwareNames.map(name => ({
    name: name,
    data: data.map(point => point[name] as number)
  }))
  
  const options = {
    chart: {
      type: 'line',
      height: 250,
      background: 'transparent',
      toolbar: {
        show: false
      },
      zoom: {
        enabled: false
      }
    },
    colors: colors,
    dataLabels: {
      enabled: false
    },
    stroke: {
      curve: 'smooth',
      width: 3,
    },
    grid: {
      borderColor: 'rgba(255, 255, 255, 0.1)',
      row: {
        colors: ['transparent'],
        opacity: 0.1
      },
      xaxis: {
        lines: {
          show: false
        }
      },
      yaxis: {
        lines: {
          show: true
        }
      },
      padding: {
        top: 0,
        right: 0,
        bottom: 0,
        left: 10
      }
    },
    xaxis: {
      categories: data.map(d => d.date),
      labels: {
        style: {
          colors: '#888',
          fontSize: '12px',
        }
      },
      axisBorder: {
        show: false
      },
      axisTicks: {
        show: false
      }
    },
    yaxis: {
      show: false
    },
    legend: {
      show: false
    },
    tooltip: {
      theme: 'dark',
      x: {
        show: false
      }
    }
  }
  
  return (
    <Card className="dashboard-card h-full">
      <CardHeader>
        <CardTitle className="dashboard-text-primary">Top Malware</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="h-[250px]">
          <ApexChart
            options={options}
            series={series}
            type="line"
            height={250}
          />
        </div>
        
        <div className="grid grid-cols-3 gap-2 mt-4">
          {malwareNames.map((name, index) => (
            <div key={index} className="flex items-center">
              <div 
                className="w-3 h-3 rounded-full mr-2" 
                style={{ backgroundColor: colors[index % colors.length] }}
              />
              <span className="text-xs truncate dashboard-text-secondary">{name}</span>
            </div>
          ))}
        </div>
      </CardContent>
    </Card>
  )
} 